%% ------------------------------------------------------------------------- %%
\chapter{Propriedades Básicas do Processo K}
\label{cap:propriedades}

Nesse capítulo vamos estabelecer resultados que serão ferramentas
básicas para trabalhar com o processo K durante o resto da
dissertação. Como uma maneira de aproxima-lo por processos Markovianos
de salto.

No final do capítulo ainda enunciaremos um resultado que tratará do
quanto tempo o processo passa no infinito.

%% ------------------------------------------------------------------------- %%

\section{Observações gerais}
\label{sec:observacoes}

Nessa seção vamos colocar várias proposições ou observações sobre o
processo, que serão usadas à exaustão em partes seguintes da
dissertação.

\begin{proposicao}
  \label{prop:gamma-crescente}
  $\Gamma$ é \qc estritamente crescente.
\end{proposicao}
\begin{proof}
  Como estamos supondo que $\sum_{x \in \Nz} \lambda_x = \infty$,
  então o conjunto das marcas dos processos de Poisson é \qc densa em
  $\R^+$. Em outras palavras, quase certamente, para todo $0 \leq s <
  t$, teremos que existe um $x \in \Nz$ e $i \geq 1$ tal que $s <
  \sigma^x_i < t$. Dessa forma usando a definição de $\Gamma$, teremos
  que:
  \begin{displaymath}
    \Gamma(t) - \Gamma(s) \geq \gamma_x T^x_i > 0
  \end{displaymath}
\end{proof}

\begin{proposicao}
  \label{prop:gamma-finita}
  Com probabilidade $1$, $\Gamma(t)$ é finito para todo $t \geq 0$.
\end{proposicao}
\begin{proof}
  Usando o teorema da convergência monótona, podemos calcular:
  \begin{displaymath}
    \E \left[\Gamma^y(t) \right] = \gamma_y + t \sum_{x \in \Nz}
    \lambda_x \gamma_x + ct < \infty
  \end{displaymath}
  Assim para cada $t \geq fixo$, teremos que $\Gamma(t)$ é quase
  certamente finito. Tomando uma sequência $t_n \to \infty$ quando $n
  \to \infty$, teremos que $P(\cap_{n = 1}^{\infty} \{ \Gamma^y (t_n)
  < \infty \} \cap \{ \Gamma \textrm{ é crescente}\}) = 1$. Assim para
  realizações dentro desse evento, teremos que para todo $t \geq 0$,
  existe um $n$ tal que $t_n > t$. Portando $\Gamma(t) < \Gamma(t_n) <
  \infty$.
\end{proof}

\begin{proposicao}
  \label{prop:reinicia-infinito}
  Para todo $y \in \Nz$ e $t \geq 0$, vale que
  $X^y(t + \gamma_y T_0^y) = X^\infty(t)$.
\end{proposicao}
\begin{proof}
  Fixe um $y \in \Nz$. Primeiramente observe que para todo $s \geq 0$,
  temos que $\Gamma^y(s) = \Gamma^\infty(s) + \gamma_yT^y_0$.

  Fixada uma realização do processo, suponha que $X^\infty(t) = x \in
  \Nz$, assim existe um $i \geq 1$ tal que $\Gamma^\infty(\sigma_i^x-)
  \leq t < \Gamma^\infty(\sigma_i^x)$. Dessa forma, somando $\gamma_y
  T^y_0$ nos termos dessa desigualdade, teremos que
  $\Gamma^y(\sigma_i^x-) \leq t+\gamma_yT_0^y <
  \Gamma^y(\sigma_i^x)$. E portanto $X^y(t+\gamma_y T_0^y) = x$.

  Com raciocínio análogo, chegamos que se $X^y(t+\gamma_y T_0^y) = x
  \in \Nz$, então $X^\infty(t) = x$. De onde concluímos a igualdade desejada.
\end{proof}


\begin{proposicao}
  \label{prop:gamma-cadlag}
  A função $\Gamma$ é quase certamente càdlàg. Isso é, é contínua à
  direita e tem limites à esquerda.
\end{proposicao}
\begin{proof}

  % Consideremos $A$ o conjunto de todas as trajetórias $\omega \in
  % \Omega$ tais que $\Gamma_y(T)$ seja finito, para todo $T$ positivo e
  % racional, além disso não haja marcas repetidas na justaposição dos
  % processos de Poisson $\{N_x: x \in \N\}$.


  % Fixe $T > 0$, e vamos definir o evento:
  % \begin{displaymath}
  %   A_T = \left\{
  %     \omega \in \Omega: \Gamma_y(T) < \infty
  %   \right\}.
  % \end{displaymath}
  % E tomemos $A = \cup_{T=1}^{\infty} A_T$. Consideremos ainda $B$ o
  % evento que diz que não há marcas repetidas na justaposição dos
  % processos de Poisson $N_x$.

  % Como $P(A_T) = 1 = P(B)$, seque que $P(A \cap B) = 1$. Assim vamos
  % mostrar que toda trajetória $\omega \in A \cap B$ é càdlàg.

  % Se tomarmos $t \geq s \geq 0$, temos que:
  % \begin{equation*}
  %   \Gamma_y(t) - \Gamma_y(s) = 
  %   c (t - s) + 
  %   \sum_{x \in \N} \sum_{n = N_x(s)+1}^{N_x(t)} \gamma_x T^x_n
  %   \geq 0 .
  % \end{equation*}


  % Assim $\Gamma_y$ é não decrescente. Tomando um $T > t$, temos ainda
  % que $0 \leq \Gamma_y(s) \leq \Gamma_y(t) \leq \Gamma_y(T) <
  % \infty$. Dessa maneira estamos lidando com sequências monótonas
  % limitadas, o que estabelece a existência dos limites à direita e à
  % esquerda.



  % Para mostrar à continuidade à direita, tome $t \geq 0$ e uma
  % sequência $(t_n)$ que convirja pela direita para $t$.
  % \begin{equation*}
  %   \E(|\Gamma_y(t_n) - \Gamma_y(t)|) =
  %   (t_n - t) \left(
  %     c + 
  %     \sum_{x \in \N}\lambda_x \gamma_x 
  %   \right) \xrightarrow{n \to \infty} 0 
  % \end{equation*}
  % Assim $\Gamma_y(t_n)$ converge na norma $L_1$ para $\Gamma_y(t)$ e
  % portanto também converge em probabilidade. Assim, como existe o
  % limite à direita \qc, então esse limite deve ser igual à
  % $\Gamma_y(t)$.


\end{proof}

\begin{proposicao}
  \label{prop:proc-cadlag}
  O processo K é quase certamente càdlàg.
\end{proposicao}
\begin{proof}

  Iremos mostrar que o processo iniciado no $\infty$ é Càdlàg. Isso
  irá mostrar que o processo é Càdlàg para qualquer condição inicial,
  visto que iniciando em $y$, iremos continuar em $y$ até $\gamma_y
  T^y_0$, e depois continuaremos como uma cópia do processo iniciado no
  $\infty$.

  Fixe uma realização do processo e fixe $T > 0$ e $\epsilon > 0$
  arbitrários. Seguindo \cite{billingsley:99}, vamos mostrar que
  existem $0 = t_0 < t_1 < \ldots < t_N = T$ tais que $w[t_{i-1}, t_i)
  < \epsilon$, para todo $i = 1, \ldots, N$. Onde $w(A) = \sum_{t, s
    \in A} |X^\infty(t) - X^\infty(s)|$ para $A \subseteq \R$.

  Tome um $m \in \Nz$ tal que o $\diam\{x \in \Nzb: x > m \} =
  \frac{1}{m+1} < \epsilon$, onde $\diam(A)$ é o diâmetro do conjunto
  $A$ na métrica \eqref{eq:metrica}.

  Agora tome $S_1 < S_2 < \ldots < S_M$ uma ordenação dos conjunto $\{
  \sigma^x_i: x \in \Nz \,\, i \geq 1 \,\, \Gamma(\sigma^x_i) \leq
  T\}$. Finalmente fixe $N = 2M+1$ se $\Gamma(S_M) < T$ e $N = 2M$
  caso contrário. Tome $t_0 = 0$, $t_N = T$ e para $i=1,\ldots, M$:
  \begin{align*}
    t_{2i-1} &= \Gamma(S_i-)\\
    t_{2i} &= \Gamma(S_i).\\
  \end{align*}

  Se $t \in [\Gamma(S_i-), \Gamma(S_i))$, teremos que
  $X(t)$ é constante, enquanto que se $t \in
  [\Gamma(S_{i-1}), \Gamma(S_{i}-))$, termos que
  $X(t) > m$, assim a variação nesse intervalo é menor ou igual
  à $\frac{1}{m} < \epsilon$. O mesmo ocorre nos intervalos $[t_0,
  t_1)$ e $[t_{N-1}, t_N)$.
\end{proof}



%% ------------------------------------------------------------------------- %%

\section{Aproximações}
\label{sec:aproximacoes}

Fixado um natural $n \in \Nz$, vamos ``truncar'' nosso processo em
$\{1, 2, \ldots, n, \infty\}$. Depois vamos mostrar mostrar que esses
processos truncados convergem ao processo original.

Primeiramente, para $n \in \Nz$ e $y \in \{1, \ldots, n, \infty\}$,
vamos definir:
\begin{equation}
  \Gamma^{(n)} := \Gamma^{y,(n)}_c (t) = \gamma_y T_0^y
  + \sum_{x =1}^{n} \sum_{i = 1}^{N_x(t)}
  \gamma_x T_i^x
  + ct.
\end{equation}

O processo truncado em $n \in \Nz$, com estado inicial $y \in \{1,
\ldots, n, \infty\}$ será:
\begin{equation}
  X^{(n)}(t) = X^{y,(n)}_c(t) = \begin{cases}
    y, & \textrm{ se }  t < \gamma_y T_0^y\\
    x, & \textrm{ se } \Gamma^{y,(n)}_c(\sigma_i^x-) \leq t <
    \Gamma^{y,(n)}_c(\sigma^x_i)
    \textrm{ para algum } i \\
    \infty, & \textrm{ caso contrário.}
  \end{cases}
\end{equation}

\begin{proposicao}
  O processo $X_n^y$ é Càdlàd e Markoviano.
\end{proposicao}
\begin{proof}
  Como visto na seção \ref{sec:visualizacao}, o processo $X_n^y$ é um
  processo Markoviano de saltos, construído para ser contínuo a
  direita.
\end{proof}

Note que nós construímos $\{(X^{(n)}(t))_t\}_{n \in \Nz}$ e $(X(t))_t$
num mesmo espaço de probabilidade. Assim é natural perguntar se
$(X^{(n)}(t))_t$ converge para $(X(t))_t$ de alguma forma.

\begin{teorema}
  \label{teo:convergencia}
  Se considerarmos a topologia introduzida na seção
  \ref{sec:topologia}, então $X^{(n)} (\bullet) \xrightarrow{n \to
    \infty} X(\bullet)$ \qc na métrica de Skorohod.
\end{teorema}

A métrica de Skorohod é uma métrica sobre o espaço das tragetórias
Càdlàg que permite pequenas distorções temporais. Como
referência recomendamos \cite{billingsley:99} e \cite{ethier:86}.


\begin{proof}
  Vamos considerar somente os processos iniciados no $\infty$, visto
  que se começarmos em um $y \in \Nz$, teremos que o processo K e os
  processos truncados serão iguais até $\gamma_y T^y_0$ e depois
  continuarão como uma cópia dos processos respectivos, mas iniciados
  no $\infty$.

  Essa demonstração foi adaptada diretamente do \emph{Lema 3.11} de
  \cite{fontes:08}.

  Para provar a proposição, vamos mostrar que o item (c) da proposição
  5.3, capítulo 5 de \cite{ethier:86} vale quase certamente.

  Fixe um $T > 0$. Para cada natural $m$, considere $\delta_m :=
  \diam\{ x \in \Nzb: x > m \} = \frac{1}{m+1}$. Tome ainda $0 = S_0^m
  < S_1^m < S_2^m < \ldots $ uma ordenação de $\{0\}\cup\{ \sigma^x_i
  : x \leq m, i \geq 1\}$. Considere ainda, para $n \in \Nz$:
  \begin{displaymath}
    L^m_n := \min \left\{ i \geq 1: \Gamma^{(n)}(S^m_i) \geq T \right\}.
  \end{displaymath}

  Como o conjunto $\{\sigma_i^x: x > m, i\geq 1\}$ é denso, temos
  que para $n$ suficientemente grande $\Gamma^{(n)}(S^m_{i+1}-) >
  \Gamma^{(n)}(S^m_i)$ para todo $i < L^m_n$.

  Para esses valores de $n$, defina $\lambda_n^m: [0, L_n^m] \to \R^+$
  da seguinte forma:
  \begin{displaymath}
    \lambda_n^m(t) = \begin{cases}
      \Gamma(S_i^m) + \frac{\Gamma(S_{i+1}^m-) - \Gamma(S_i^m)}
      {\Gamma^{(n)}(S_{i+1}^{(m)} -) - \Gamma^{(n)}(S_i^m)}
      \left[t - \Gamma^{(n)}(S_i^m)\right]
      & \textrm{ se }
      \Gamma^{(n)}(S_i^m) \leq t \leq \Gamma^{(n)}(S_{i+1}^m-) \\
      \Gamma(S_{i+1}^m-) - \Gamma^{(m)}(S_{i+1}^m-) + t
      & \textrm{ se }
      \Gamma^{(n)}(S_{i+1}^m-) \leq t \leq \Gamma^{(n)}(S_{i+1}^m).
    \end{cases}
  \end{displaymath}

  Para entender o que motivou essa definição, observe que para $i = 0,
  \ldots L_n^m$, teremos que:
  \begin{align*}
    \lambda_n^m(\Gamma^{(n)}(S_i^m-)) &= \Gamma(S_i^m-)\\
    \lambda_n^m(\Gamma^{(n)}(S_i^m)) &= \Gamma(S_i^m).
  \end{align*}
  Enquanto que nos pontos interiores, ``completamos'' $\lambda_n^m$ de
  maneira linear.

  Como $\Gamma(t) \geq \Gamma^{(n)}(t)$ para todo $n \in \Nz$, teremos
  que $\lambda(t) \geq t$. Usando a linearidade por partes, e o fato
  que $\Gamma(\sigma^x_i) = \Gamma(\sigma_i^x-) + \gamma_x T^x_i$,
  teremos que:
  \begin{displaymath}
    \sup_{0 \leq t \leq T} |\lambda_n^m(t) - t| =
    \max_{0 \leq i \leq L_n^m} \{ \Gamma(S_i^m) -
    \Gamma^{(n)}(S_i^m)\}.
  \end{displaymath}
  Essa quantidade converge quase certamente à zero se mantivermos o
  $m$ fixo e jogarmos o $n$ para infinito. Assim para cada $m$ existe
  um $n_m$ tal que para $n \geq n_m$ vale que:
  \begin{displaymath}
    \sup_{0 \leq t \leq T} |\lambda_n^m(t) - t| < \delta_m.
  \end{displaymath}
  Podemos tomar a sequência $(n_m)_{m \geq 1}$ de modo que ela seja
  crescente. Agora vamos ``inverte-la'', isso é, para cada n em $\Z
  \cap [n_{i-1}, n_i)$, defina $m_n = i$. Teremos que:
  \begin{displaymath}
    \sup_{0 \leq t \leq T} |\lambda_n^{m_n}(t) - t| < \delta_{m_n}.
  \end{displaymath}
  Ainda como, para cada $m$ fixado, $n_m$ é finito, vale que $m_n$ vai
  ao infinito quando $n \to \infty$.
  
  Agora note que $t \in [\Gamma^{(n)}(S_{i}^m-),
  \Gamma^{(n)}(S_{i}^m))$ se e somente se $\lambda_n^m(t) \in
  [\Gamma(S_{i}^m-), \Gamma(S_{i}^m))$. Assim $X(\lambda_n^m(t)) \leq
  m$ se e somente se $X^{(n)}(t) \leq m$. De onde concluímos que:
  \begin{displaymath}
    \sup_{0 \leq t \leq T} d\left(X(\lambda_n^m(t)), X^{(n)}\right)
    \leq \delta_m
  \end{displaymath}

  Assim tomando $\tilde{\lambda}_n = \lambda_n^{m_n}$, concluímos que
  quase certamente:
  \begin{align*}
    \sup_{0 \leq t \leq T} |\tilde{\lambda}_n(t) - t|
    &\xrightarrow{n\to\infty} 0 \\
    \sup_{0 \leq t \leq T} d(X(\tilde{\lambda}_n(t)), X^{(n)}(t)
    &\xrightarrow{n\to\infty} 0 \\
  \end{align*}
\end{proof}

%% ------------------------------------------------------------------------- %%

\section{Propriedade de Markov}
\label{sec:prop-markov}
\begin{teorema}
  \label{teo:proc_markov}
  $X^y$ é um processo markoviano.
\end{teorema}

\begin{proof}
  ....
\end{proof}

\begin{proposicao}
  \label{prop:proc_feller}
  $X^y$ é um processo de Feller.
\end{proposicao}
\begin{proof}
  Um processo é de Feller se o seu semigrupo de transição for um
  operador contínuo...
\end{proof}



\begin{corolario}
  \label{cor:proc_fort_markov}
  $X^y$ é fortemente markoviano.
\end{corolario}
\begin{proof}
  Um processo de Feller markoviano é fortemente markoviano. Ver (???)
\end{proof}



%%% Local Variables: 
%%% TeX-master: "tese"
%%% End: 
